(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{357:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),a("p",[t._v("📝 참고한 글")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://spring.io/blog/2016/06/07/notes-on-reactive-programming-part-i-the-reactive-landscape",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reactive landscape"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.reddit.com/r/java/comments/6acxe3/spring_reactor_vs_rxjava/",target:"_blank",rel:"noopener noreferrer"}},[t._v("spring_reactor_vs_rxjava"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"_1-reactive-landscape-에-언급된-rxjava-reactor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-reactive-landscape-에-언급된-rxjava-reactor"}},[t._v("#")]),t._v(" 1. "),a("a",{attrs:{href:"https://spring.io/blog/2016/06/07/notes-on-reactive-programming-part-i-the-reactive-landscape",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reactive landscape"),a("OutboundLink")],1),t._v(" 에 언급된 RxJava, Reactor")]),t._v(" "),a("h3",{attrs:{id:"_1-1-rxjava-소개"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-rxjava-소개"}},[t._v("#")]),t._v(" 1.1. "),a("a",{attrs:{href:"https://github.com/ReactiveX/RxJava/wiki",target:"_blank",rel:"noopener noreferrer"}},[t._v("RxJava"),a("OutboundLink")],1),t._v(" 소개")]),t._v(" "),a("p",[t._v("RxJava 는 JVM을 위한 ReactiveX (Reactive Extensions) 라이브러리입니다."),a("br"),t._v("\n넷플릭스는 꽤 오랜기간동안 리액티브 패턴을 사용해오면서 Netflix/RxJava 를 오픈소스로 공개하였고, 현재는 ReactiveX/RxJava 로 불립니다. "),a("a",{attrs:{href:"https://github.com/ReactiveX/RxJavaReactiveStreams",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reactive Streams 에 대한 브릿지"),a("OutboundLink")],1),t._v("가 있습니다. RxJava는 David Karnok의 "),a("a",{attrs:{href:"https://akarnokd.blogspot.co.uk/2016/03/operator-fusion-part-1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reactive 세대 분류 체계"),a("OutboundLink")],1),t._v("에 따르면 2세대 라이브러리입니다.")]),t._v(" "),a("h3",{attrs:{id:"_1-2-reactor-소개"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-reactor-소개"}},[t._v("#")]),t._v(" 1.2. "),a("a",{attrs:{href:"https://projectreactor.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reactor"),a("OutboundLink")],1),t._v(" 소개")]),t._v(" "),a("p",[t._v("Reactor는 Pivotal 의 오픈소스팀 (Spring 만든 팀) 이 만든 Java 프레임워크입니다. 이 프레임워크는 Reactive Stream 상에서 직접 빌드되므로 브릿지가 필요없습니다. Reactor IO 프로젝트는 Netty, Aeron 과 같은 저수준 네트워크 런타임에 대한 래퍼를 제공합니다. Reactor는 David Karnok의 "),a("a",{attrs:{href:"https://akarnokd.blogspot.co.uk/2016/03/operator-fusion-part-1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reactive 세대 분류 체계"),a("OutboundLink")],1),t._v("에 따르면 4세대 라이브러리입니다.")]),t._v(" "),a("h2",{attrs:{id:"_2-spring-reactor-vs-rxjava"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-spring-reactor-vs-rxjava"}},[t._v("#")]),t._v(" 2. "),a("a",{attrs:{href:"https://www.reddit.com/r/java/comments/6acxe3/spring_reactor_vs_rxjava/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Spring Reactor vs RxJava"),a("OutboundLink")],1)]),t._v(" "),a("blockquote",[a("h3",{attrs:{id:"david-karnok-on-twitter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#david-karnok-on-twitter"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://twitter.com/akarnokd/status/774590596740685824?ref_src=twsrc%5Etfw",target:"_blank",rel:"noopener noreferrer"}},[t._v("David Karnok on Twitter"),a("OutboundLink")],1)]),t._v(" "),t._m(2)]),t._v(" "),a("blockquote",[a("h3",{attrs:{id:"pivotal-reactor-core-3-0-becomes-a-unified-reactive-foundation-on-java-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pivotal-reactor-core-3-0-becomes-a-unified-reactive-foundation-on-java-8"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://spring.io/blog/2016/03/11/reactor-core-3-0-becomes-a-unified-reactive-foundation-on-java-8",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pivotal - Reactor Core 3.0 becomes a unified Reactive Foundation on Java 8"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Reactor 2.5 -> 3.0 으로 업그레이드 할 때 Java8 이상을 기본으로 설계되었습니다. Java8 을 기본으로 하면서 얻을 수 있는 혜택은 아래와 같습니다.")]),t._v(" "),a("ul",[t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),a("li",[t._v("특히 "),a("a",{attrs:{href:"https://github.com/reactor/reactor-addons",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reactor Addons"),a("OutboundLink")],1),t._v(" 사용시 "),a("code",[t._v("ConcurrentHashMap")]),t._v("에 대한 JSR 166 backport 제거")]),t._v(" "),a("li",[t._v("Spring framework 5 가 제공하는 프로그래밍 경험에 더 가깝게 다가설 수 있음")])])]),t._v(" "),a("blockquote",[a("h3",{attrs:{id:"infoq-reactor-by-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#infoq-reactor-by-example"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.infoq.com/articles/reactor-by-example",target:"_blank",rel:"noopener noreferrer"}},[t._v("InfoQ - Reactor by Example"),a("OutboundLink")],1)]),t._v(" "),t._m(8)]),t._v(" "),a("p",[t._v("— 접기/펼치기"),a("br"),t._v("\nRxJava2는 "),a("a",{attrs:{href:"http://www.reactive-streams.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reactive Streams 표준"),a("OutboundLink")],1),t._v(" 이 정의 된 이후에 개발되었기 때문에, Publisher 를 (RxJava2 에서) 새로운 타입인 Flowable 로 직접 구현했습니다."),a("br"),t._v("\n그러나 RxJava2 는 RS 타입에 오롯이 집중하지 않고, RxJava1 타입인 "),a("code",[t._v("Observable")]),t._v(", "),a("code",[t._v("Completeable")]),t._v(", "),a("code",[t._v("Single")]),t._v(" 을 유지하면서 RxJava Optional 을 도입합니다. 이러한 것들이 의미론적으로는 리액티브 프로그래밍을 제공하기는 하지만, RS 인터페이스를 구현하지 않음으로써 따르는 단점이 있습니다."),a("br"),t._v("\nRxJava1 에서 전체적으로 지원하려 했던 backpressure 는 RxJava2에서는 "),a("code",[t._v("Flowable")]),t._v(" 에 한해서만 지원합니다. ("),a("code",[t._v("Completeable")]),t._v(", "),a("code",[t._v("Single")]),t._v(", "),a("code",[t._v("Maybe")]),t._v(" 는 backpressure 가 비현실적이거나 불가능한 사용자 인터페이스 이벤트와 같은 경우를 위해 유지되었습니다. backpressure 를 지원하지 않는 설계로 인해, 풍부한 API 를 제공하고 구독되기 전까지 모든 작업을 연기할 수 있습니다.)"),a("br"),t._v("\n반면에 Reactor의 Mono, Flux 타입을 살펴보면 Publisher와 Backpressure-ready를 모두 구현합니다. Mono가 Publisher 로서 동작하려면 상대적으로 약간의 오버헤드가 있지만 대부분 Mono 최적화에 의해 상쇄할만한 수준입니다.")]),t._v(" "),t._m(9),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://docs.spring.io/spring/docs/current/spring-framework-reference/web-reactive.html#webflux",target:"_blank",rel:"noopener noreferrer"}},[t._v("Spring WebFlux"),a("OutboundLink")],1)])]),t._v(" "),t._m(10),t._v(" "),a("p",[a("code",[t._v("org.springframework.boot:spring-boot-starter-webflux")]),a("br"),t._v(" "),a("a",{attrs:{href:"https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-webflux/2.0.4.RELEASE",target:"_blank",rel:"noopener noreferrer"}},[t._v("maven central repository :: spring-boot-starter-webflux"),a("OutboundLink")],1)]),t._v(" "),t._m(11),t._v(" "),a("p",[t._v("Spring5 부터 request routing 방법이 두가지로 나누어 집니다.")]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),a("p",[t._v("기존 Spring MVC 어노테이션 기반의 방법은 모두 익히 알고 있는 방법이니, 이번 맛보기는 Functional Endpoints 방식으로 살펴보겠습니다.")]),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),a("p",[a("code",[t._v("RouterFunction")]),t._v(", "),a("code",[t._v("HandlerFunction")]),t._v(" 을 사용하는 방법은 아래 예제 코드를 참고해주세요."),a("br"),t._v(" "),a("a",{attrs:{href:"https://spring.io/blog/2016/09/22/new-in-spring-5-functional-web-framework",target:"_blank",rel:"noopener noreferrer"}},[t._v("spring.io :: Functional endpoints 예제"),a("OutboundLink")],1),t._v(" 기반입니다.")]),t._v(" "),t._m(21)])}),[function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Spring 으로 서버 개발을 할 때, RxJava와 Reactor 중 어느 것을 쓰는게 좋을지 고민이 되었는데, 몇가지 자료들을 검토해 본 결과 "),s("strong",[this._v("Reactor")]),this._v(" 를 사용해 보기로 결론을 내렸습니다.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("“Spring 으로 서버 개발은 Reactor 로 해보자”")]),this._v(" 결론의 토대가 된 자료들에 대해 정리한 글입니다.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("(David Karnok: RxJava PL 이자, Reactor3 엔진 Contributor)"),s("br"),this._v("\nJava8 이상을 사용할 수 있으면 Reactor3 을 사용하세요."),s("br"),this._v("\nJava6 에서 벗어나기 힘들거나, checked exception 이 꼭 필요하면 RxJava2 를 사용하세요.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("code",[this._v("reactor.fn")]),this._v(" 에서 functional callback 을 위해 별도로 만들었던 것들을 "),s("code",[this._v("java.util.function")]),this._v(" 으로 대체함 => 표준 대화형 지침과 경쟁적인 표면 API 제공이 가능해짐 (: 개발자들이 사용하기가 더 낫다)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("code",[this._v("Flux")]),this._v(" <=> "),s("code",[this._v("java.util.stream.Stream")]),this._v(" 변환 가능")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("code",[this._v("Mono")]),this._v(" <=> "),s("code",[this._v("CompletableFuture")]),this._v(" 변환 가능")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("code",[this._v("Optional")]),this._v("로 "),s("code",[this._v("Mono")]),this._v("를 안전하게 생성 가능")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("code",[this._v("Duration")]),this._v("으로 온전한 기간 지원")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("RxJava2 가 Reactive Streams 표준 이후에 개발되면서 Reactive Streams 인터페이스를 구현하기는 했지만, 별도의 backpressure 지원용 클래스 Flowable 를 만들고 RxJava1 의 "),s("code",[this._v("Observable")]),this._v(", "),s("code",[this._v("Completeable")]),this._v(", "),s("code",[this._v("Single")]),this._v(" 의 backpressure 지원 제거와, 해당 클래스는 계속 유지하는 등 Reactive Streams 표준을 준수하지는 않습니다.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-spring5-reactor-맛보기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-spring5-reactor-맛보기"}},[this._v("#")]),this._v(" 3. Spring5 - Reactor 맛보기")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-1-dependency-추가하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-dependency-추가하기"}},[this._v("#")]),this._v(" 3.1. dependency 추가하기")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-2-request-routing-등록-request-처리하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-request-routing-등록-request-처리하기"}},[this._v("#")]),this._v(" 3.2. request routing 등록, request 처리하기")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_3-2-1-annotated-controllers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-annotated-controllers"}},[this._v("#")]),this._v(" 3.2.1. Annotated Controllers")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("기존에 사용하는 방식(Spring MVC 어노테이션 기반)으로 "),a("code",[t._v("@Controller")]),t._v(", "),a("code",[t._v("@RestController")]),t._v(", "),a("code",[t._v("@RequestMapping")]),t._v(", "),a("code",[t._v("@GetMapping")]),t._v(" … 을 이용하는 방법입니다.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_3-2-2-functional-endpoints"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-functional-endpoints"}},[this._v("#")]),this._v(" 3.2.2. Functional Endpoints")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("함수형 프로그래밍 방식의 "),s("code",[this._v("HandlerFunction")]),this._v(", "),s("code",[this._v("RouterFunction")]),this._v(" 을 이용하는 방법입니다."),s("br"),this._v("\nrequest 라우팅과 처리를 위한 람다 기반의 가벼운 함수형 프로그래밍 모델을 지원합니다.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"_3-2-2-1-routerfunction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-1-routerfunction"}},[this._v("#")]),this._v(" 3.2.2.1 RouterFunction")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("request 라우팅하는데 사용됩니다. 일반적으로 "),s("code",[this._v("RouterFunctions.route(RequestPredicate, HandlerFunction)")]),this._v(" 같은 방식으로 라우팅 합니다.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"_3-2-2-2-handlerfunction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-2-handlerfunction"}},[this._v("#")]),this._v(" 3.2.2.2 HandlerFunction")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("HTTP 요청/응답을 JDK8 친화적으로 접근 할 수 있고, Reactive Streams 표준에 부합하는 immutable interface ("),a("code",[t._v("ServerRequest")]),t._v(", "),a("code",[t._v("ServerResponse")]),t._v(") 입니다. request body 는 "),a("code",[t._v("Flux")]),t._v(", "),a("code",[t._v("Mono")]),t._v(" 으로, response body 는 "),a("code",[t._v("Publisher (Flux, Mono 포함)")]),t._v(" 로 처리합니다.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-3-reactor-사용하는-예제-코드"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-reactor-사용하는-예제-코드"}},[this._v("#")]),this._v(" 3.3. reactor 사용하는 예제 코드")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SpringBootApplication")]),t._v("  \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DemoReactorApplication")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringApplication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DemoReactorApplication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("  \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RouterFunction")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("routingFunction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PersonRepository")]),t._v(" repository "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DummyPersonRepository")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PersonHandler")]),t._v(" handler "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PersonHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("route")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/person/{id}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("and")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("accept")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APPLICATION_JSON"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPerson")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("andRoute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/person"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("and")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("accept")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APPLICATION_JSON"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listPeople")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("andRoute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("POST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/person"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPerson")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PersonHandler")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PersonRepository")]),t._v(" repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PersonHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PersonRepository")]),t._v(" repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mono")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPerson")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" personId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("valueOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pathVariable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mono")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" notFound "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("notFound")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mono")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" personMono "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPerson")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("personId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" personMono  \n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("flatMap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("person "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ok")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("contentType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APPLICATION_JSON"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fromObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("switchIfEmpty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notFound"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n       "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  \n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mono")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPerson")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mono")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" person "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bodyToMono")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ok")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("savePerson")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  \n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Mono")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listPeople")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Flux")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" people "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("allPeople")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServerResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ok")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("contentType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APPLICATION_JSON"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("people"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n       "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])}],!1,null,null,null);s.default=e.exports}}]);